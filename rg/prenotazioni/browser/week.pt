<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:metal="http://xml.zope.org/namespaces/metal"
      xmlns:tal="http://xml.zope.org/namespaces/tal"
      metal:use-macro="context/main_template/macros/master"
      i18n:domain="rg.prenotazioni"
      >

    <metal:block fill-slot="content-description">
        <div class="documentDescription-box clear-block">
            <p class="documentDescription">
                <tal:block condition="here/Description">
                    <metal:field use-macro="python:here.widget('description', mode='view')">Description</metal:field>
                </tal:block>
            </p>
        </div>

        <div class="documentDescription-box clear-block">
            <span tal:replace="structure here/getDescriptionAgenda" />
        </div>

        <div tal:define="tipology_durations view/prenotazioni/tipology_durations;
                         keys python:sorted(tipology_durations.keys())">
          <h3 i18n:translate="label_tipologies">Reservation types</h3>
          <p i18n:translate="help_tipologies">List of available reservation type for the current agenda</p>
          <table class="tipology-table">
            <tr>
              <th i18n:translate="tipology_name">Name</th>
              <th i18n:translate="tipology_value">Value</th>
            </tr>
            <tal:repeat repeat="key keys">
              <tr>
                <td><span tal:replace="key" /></td>
                <td><span tal:replace="python:tipology_durations[key]" /></td>
              </tr>
            </tal:repeat>
          </table>
        </div>
        <fieldset id="legend">
          <legend i18n:translate="legend">Legend</legend>
          <p i18n:translate="legend-description">
            Short description of available action for the booking board
          </p>
          <ul id="legend-items" class="legend legend-user" tal:condition="python:not view.user_can_manage">
              <li><i18n:tag translate="bookable_time">Bookable time</i18n:tag>
                  <div class="bookable">&nbsp;</div></li>
              <li><i18n:tag translate="unbookable_time">Unbookable time</i18n:tag>
                  <div class="unbookable">&nbsp;</div></li>
          </ul>
          <ul id="legend-items" class="legend legend-manager" tal:condition="python:view.user_can_manage">
              <li><i18n:tag translate="bookable_time">Bookable time</i18n:tag>
                  <div class="bookable">&nbsp;</div></li>
              <li><i18n:tag translate="unbookable_time">Unbookable time</i18n:tag>
                  <div class="unbookable">&nbsp;</div></li>
              <li><i18n:tag translate="booking_confirmed">Booking confirmed</i18n:tag>
                  <div class="confirmed">&nbsp;</div></li>
              <li><i18n:tag translate="booking_pending">Booking pending</i18n:tag>
                  <div class="pending">&nbsp;</div></li>
              <li><i18n:tag translate="booking_refused">Booking refused</i18n:tag>
                  <div class="refused">&nbsp;</div></li>
              <li><i class="icon-search"></i>
                  <i18n:tag translate="view_booking">View booking</i18n:tag></li>
              <li><i class="icon-cut"></i>
                  <i18n:tag translate="move_booking">Move booking</i18n:tag></li>
          </ul>
          <p class="legend-note">
            <strong>Note</strong>:
            <i18n:tag translate="legend_note">
                The minimum value of a single slot is 5 minutes.
                You cannot book a reservation when the needed time exceeds the available time.
            </i18n:tag>
            </p>
        </fieldset>
    </metal:block>

    <metal:block fill-slot="content-core"
                 tal:define="week_view nocall:view;
                             prenotazione_macros nocall:here/@@prenotazione_macros;
                             slot_macro python:week_view.user_can_manage and prenotazione_macros['manager_slot'] or prenotazione_macros['anonymous_slot'];">

        <div>
          <p i18n:translate="book_it">
              Please select a booking slot clicking on the green area.
          </p>
        </div>

        <table id="week" class="pren">
          <caption>
            <metal:macro metal:use-macro="prenotazione_macros/week_navigator" />
          </caption>
          <thead>
              <tr>
                  <tal:days repeat="day view/actual_week_days">
                      <th scope="col" tal:content="python:day.strftime('%d')">Lunedi</th>
                  </tal:days>
              </tr>
          </thead>
          <tbody>
              <tal:periods repeat="period view/periods">
                <metal:macro metal:use-macro="prenotazione_macros/day_period" />
              </tal:periods>
          </tbody>
      </table>
    </metal:block>
</html>
